#pragma once
#include "main.h"
#include "Helper.h"

/*
	Author:		Lim Seok Min
	Email:		a0073541@nus.edu.sg
	Purpose:	To perform vmware detection via various techniques

	Reference:
	http://www.ouah.org/Red_%20Pill.html
	http://www.trapkit.de/research/vmm/scoopyng/
	http://www.offensivecomputing.net/dc14/vmdetect.cpp
	http://www.codeproject.com/Articles/9823/Detect-if-your-program-is-running-inside-a-Virtual	

*/

class vmware
{
public:
	vmware(void);
	~vmware(void);

	void startDetect();
private:
	void sidt();
	void sldt();
	void str();
	void smsw();
	void redpill();
	void in();

	// primitive
	
	void checkRegistry();
	void checkProcess();
	void checkFile();
	void checkMAC();
};


#include "virtualpc.h"
#include "Helper.h"

virtualpc::virtualpc(void)
{
}


virtualpc::~virtualpc(void)
{
}

void virtualpc::startDetect(){
	printf("========= Checks for VirtualPC =======\n");
	printf("Instruction Check.\n");
	checkInvalidInstruction();
	printf("\n");
}

void virtualpc::checkInvalidInstruction(){
	__try{
		__asm{
			mov eax, 1
			_emit 0x0F
			_emit 0x3F
			_emit 0x07
			_emit 0x0B
			_emit 0xC7
			_emit 0x45
			_emit 0xFC
			_emit 0xFF
			_emit 0xFF
			_emit 0xFF
			_emit 0xFF
		}
	}__except(1){
		return;
	}

	printf("VirtualPC: VirtualPC passes this instruction which is supposed to be invalid.");
}